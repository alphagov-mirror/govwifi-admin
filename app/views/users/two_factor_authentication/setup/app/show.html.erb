<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <h2 class="govuk-heading-l">Two factor authentication setup</h2>
    <%= form_tag "/users/two_factor_authentication", method: :put do %>
      <ol class="govuk-list govuk-list--number">
        <li>
          Scan the QR code below using an authentication app on your phone.
          <%= image_tag(qr_code_uri, width: 180, alt: "QR Code") %>
        </li>
        <li>
          <%= hidden_field_tag :method, "app" %>
          <%= hidden_field_tag :otp_secret_key, @otp_secret_key %>
          <div class="govuk-form-group">
            <%= label_tag :code, "Enter the six digit code generated by the authentication app on your phone.",
                          class: "govuk-label govuk-!-margin-bottom-3" %>
            <%= text_field_tag :code, nil,
                               class: "govuk-input mfa-code",
                               maxlength: 6,
                               placeholder: "123456",
                               autocomplete: "off",
                               autofocus: true %>
          </div>
        </li>
      </ol>
      <%= submit_tag t(".complete_setup"), class: "govuk-button govuk-!-margin-right-1" %>
      <%= link_to t(".go_back"), "/users/two_factor_authentication/setup", class: "govuk-button govuk-button--secondary govuk-!-margin-right-1" %>
    <% end %>
  </div>
</div>
